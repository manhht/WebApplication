@using WebApplication.Model;
@model List<Issue>

@{
    var gridView = Html.DevExpress().GridView(gridViewSettings =>
    {
        gridViewSettings.Name = "gridView";
        gridViewSettings.KeyFieldName = "Id";

        gridViewSettings.CallbackRouteValues = new { Controller = "GridView", Action = "GridViewPartial" };
        gridViewSettings.CustomActionRouteValues = new { Controller = "GridView", Action = "GridViewCustomActionPartial" };
        gridViewSettings.SettingsEditing.AddNewRowRouteValues = new { Controller = "GridView", Action = "GridViewAddNewPartial" };
        gridViewSettings.SettingsEditing.UpdateRowRouteValues = new { Controller = "GridView", Action = "GridViewUpdatePartial" };

        gridViewSettings.Columns.Add(columnSettings =>
        {
            columnSettings.FieldName = "Subject";
            columnSettings.Caption = "Subject";

            columnSettings.Width = System.Web.UI.WebControls.Unit.Pixel(300);
            columnSettings.CellStyle.HorizontalAlign = HorizontalAlign.Left;
            columnSettings.ExportCellStyle.HorizontalAlign = HorizontalAlign.Left;
            columnSettings.SetDataItemTemplateContent(c =>
            {
                Html.DevExpress().HyperLink(hyperLinkSettings =>
                {
                    hyperLinkSettings.Properties.Text = (string)DataBinder.Eval(c.DataItem, "Subject");
                    hyperLinkSettings.NavigateUrl = Url.Action("GridViewDetailsPage", "GridView", new { id = DataBinder.Eval(c.DataItem, "Id") });
                }).Render();
            });

            columnSettings.Settings.FilterMode = ColumnFilterMode.DisplayText;
            columnSettings.Settings.SortMode = DevExpress.XtraGrid.ColumnSortMode.DisplayText;
        });
        gridViewSettings.Columns.Add(columnSettings =>
        {
            columnSettings.FieldName = "Customer.FullName";
            columnSettings.Caption = "Customer Name";
        });
        gridViewSettings.Columns.Add(columnSettings =>
        {
            columnSettings.FieldName = "Customer.Email";
        });

        GridViewSettingHelper.SettingGridView(gridViewSettings);
    });
    if (ViewBag.GeneralError != null)
    {
        gridView.SetEditErrorText(ViewBag.GeneralError);
    }
}

@gridView.Bind(Model).GetHtml()